@using System.Net.Http;
@using System.Text;
@using System.Threading;
@using Newtonsoft.Json;

@{
    ViewData["Title"] = "Home Page";
}

    <div class="text-center">
        <h1 class="display-4">Welcome</h1>
        <p>Hello, world! The time on the server is @DateTime.Now</p>
        <p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>
    </div>

@{
    for (int i = 0; i < 10; i++)
    {
        List<string> sinal = new List<string>
        {
            "G-1",
            "G-2",
            "A-60x60-1",
            "g-30x30-1",
            "g-30x30-2",
            "A-30x30-1"
        };

        List<string> algoritimo = new List<string>
        {
            "CGNE",
            "CGNR"
        };

        var random = new Random();
        int indiceAleatorio = random.Next(sinal.Count);
        string stringAleatoria = sinal[indiceAleatorio];
        // Crie uma instância do HttpClient
        using (var httpClient = new HttpClient())
        {
            // Configure a URL do endpoint do controller
            var url = "https://localhost:44321" + Url.Action("SendData", "Usuario");
            var conteudo = new StringContent(JsonConvert.SerializeObject(stringAleatoria), Encoding.UTF8, "application/json");

            // Envie a requisição POST para o endpoint
            var response = await httpClient.PostAsync(url, conteudo);

            // Verifique se a requisição foi bem-sucedida
            if (response.IsSuccessStatusCode)
            {
                // Requisição bem-sucedida, faça algo aqui se necessário
            }
            else
            {
                // Requisição falhou, trate o erro aqui se necessário
            }
        }
        Thread.Sleep(random.Next(60000));
    }
}
